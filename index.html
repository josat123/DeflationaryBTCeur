<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DBTCEUR · Deflationary BTCEUR Protocol</title>
  <meta name="description" content="DBTCEUR — Deflationary protocol. LP rewards, long holders rewards, and programmable burn. Contract verified on Polygon." />
  <link rel="icon" href="assets/DBTCEUR-32.svg" type="image/svg+xml" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <style>
    :root{--bg:#071028;--card:rgba(255,255,255,0.04);--accent:#2A6FB2;--accent2:#F3C24A;--muted:#98A3B3;--radius:12px;--maxw:1200px}
    *{box-sizing:border-box} html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;color:#eef2f7;background:linear-gradient(180deg,#031223 0%,var(--bg) 100%);-webkit-font-smoothing:antialiased}
    a{color:inherit}
    .container{max-width:var(--maxw);margin:0 auto;padding:0 20px}
    header{position:sticky;top:0;background:rgba(3,6,20,0.9);backdrop-filter:blur(6px);border-bottom:1px solid rgba(255,255,255,0.03);z-index:50}
    .header-inner{display:flex;align-items:center;justify-content:space-between;height:72px}
    .brand{display:flex;align-items:center;gap:12px}
    .brand img{width:40px;height:40px}
    nav{display:flex;gap:16px;align-items:center}
    nav a{color:var(--muted);text-decoration:none;font-weight:600;font-size:0.95rem}
    .cta{display:flex;gap:10px;align-items:center}
    .btn{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#071028;padding:10px 14px;border-radius:10px;border:0;font-weight:700;cursor:pointer;text-decoration:none}
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 12px;border-radius:10px;color:var(--muted)}

    .hero{padding:88px 0 36px;text-align:center}
    .hero h1{font-size:2.2rem;margin:0 0 8px;background:linear-gradient(90deg,#fff,var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .hero p{color:var(--muted);max-width:900px;margin:8px auto 20px;font-size:1rem}
    .metrics{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:16px}
    .metric{background:var(--card);padding:10px 14px;border-radius:10px;border:1px solid rgba(255,255,255,0.02);min-width:150px}
    .metric .v{font-size:1.15rem;font-weight:800;color:var(--accent)}
    section{padding:44px 0}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:18px}
    .card{background:rgba(255,255,255,0.02);padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
    .contract-bar{display:flex;gap:8px;justify-content:center;align-items:center;flex-wrap:wrap}
    .mono{font-family:monospace;background:var(--card);padding:8px 12px;border-radius:8px}
    footer{padding:32px 0;border-top:1px solid rgba(255,255,255,0.02)}
    .small{font-size:0.9rem;color:var(--muted)}
    @media(max-width:900px){.hero h1{font-size:1.6rem}}
  </style>
</head>
<body>
  <header>
    <div class="container header-inner" role="banner">
      <div class="brand" aria-hidden="false">
        <img src="assets/DBTC.svg" alt="DBTC logo (DBTC)" />
        <div>
          <div style="font-weight:800">DBTCEUR</div>
          <div style="font-size:0.85rem;color:var(--muted)">Deflationary BTCEUR Protocol</div>
        </div>
      </div>

      <nav role="navigation" aria-label="Main navigation">
        <a href="#protocol">Protocol</a>
        <a href="#tokenomics">Tokenomics</a>
        <a href="#contract">Contract</a>
      </nav>

      <div class="cta" role="toolbar">
        <button id="connect" class="btn-ghost" aria-label="Connect wallet"><i class="fas fa-wallet"></i>&nbsp;<span id="acct">Connetti</span></button>
        <a class="btn" href="https://deflationarybtceur.online/whitepaper" target="_blank" rel="noopener">Whitepaper</a>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="hero" id="home" aria-labelledby="h1">
      <h1 id="h1">DBTCEUR — Deflationary BTCEUR</h1>
      <p>Protocollo deflazionario con distribuzione fee: LP 60% | Long 30% | Burn 10%. Supply controllata e governance DAO.</p>

      <div class="metrics" role="list" aria-label="Key on-chain metrics">
        <div class="metric" role="listitem"><div class="v" id="name">—</div><div class="small">Name</div></div>
        <div class="metric" role="listitem"><div class="v" id="symbol">—</div><div class="small">Symbol</div></div>
        <div class="metric" role="listitem"><div class="v" id="supply">—</div><div class="small">Total Supply</div></div>
        <div class="metric" role="listitem"><div class="v" id="balance">—</div><div class="small">Your Balance</div></div>
      </div>
    </section>

    <section id="protocol">
      <h2 style="text-align:center;margin-bottom:16px">Protocol overview</h2>
      <div class="grid">
        <div class="card"><h3>Burn & Supply</h3><p>Burn programmato e manuale con limiti minimi; governance DAO può attivare ritmi di burn secondo regole contrattuali. Logica on-chain immutabile.</p></div>
        <div class="card"><h3>Rewards</h3><p>Fee pool distribuito automaticamente: 60% LP, 30% long, 10% burn. Distribuzione paginata per evitare gas explosion.</p></div>
        <div class="card"><h3>Security</h3><p>Funzioni pausable, reentrancy guard. Nessuna chiave/secret nel repo; audit esterno consigliato prima di marketing massivo.</p></div>
      </div>
    </section>

    <section id="tokenomics">
      <h2 style="text-align:center;margin-bottom:16px">Tokenomics</h2>
      <div class="grid">
        <div class="card"><h3>Initial Supply</h3><p>700,000,000 DBTC€ (configurabile in contratto). Target operativo 500,000,000, minimo 250,000,000.</p></div>
        <div class="card"><h3>Distribution</h3><p>Owner / Treasury / DAO / Liquidity / Team secondo tokenomics ufficiale (caricato in repo: whitepaper + tokenomics.json).</p></div>
        <div class="card"><h3>Immutable owner fee</h3><p>Wallet immutabile per fee owner (0.1% o 0.2% depending) settato al deploy fuori repo; non codificare chiavi nel codice sorgente.</p></div>
      </div>
    </section>

    <section id="contract">
      <h2 style="text-align:center;margin-bottom:12px">Contract</h2>
      <div style="text-align:center" class="contract-bar">
        <div class="mono" id="addr">0x32466616c9fca520cccc2e7b057cf99e9a4136cd</div>
        <button class="btn-ghost" onclick="copyAddr()">Copia</button>
        <a class="btn" href="https://polygonscan.com/address/0x32466616c9fca520cccc2e7b057cf99e9a4136cd" target="_blank" rel="noopener">PolygonScan</a>
        <a class="btn-ghost" href="https://app.uniswap.org/swap?outputCurrency=0x32466616c9fca520cccc2e7b057cf99e9a4136cd" target="_blank" rel="noopener">Uniswap</a>
      </div>
    </section>
  </main>

  <footer class="container">
    <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap">
      <div class="small">© DBTCEUR 2025 — Tutti i diritti riservati</div>
      <div style="display:flex;gap:10px;align-items:center">
        <a class="small" href="https://github.com/josat123/DBTC" target="_blank" rel="noopener">Repository</a>
        <a class="small" href="mailto:admin@deflationarybtc.online">Contact</a>
      </div>
    </div>
  </footer>

  <!-- ethers.js (per compatibilità e manutenzione a lungo termine) -->
  <script src="https://cdn.ethers.io/lib/ethers-5.7.umd.min.js" type="application/javascript"></script>

  <script>
    // CONFIG: cambia qui l'indirizzo del contratto se vuoi (già impostato a quello che mi hai passato)
    const CONTRACT_ADDRESS = "0x32466616c9fca520cccc2e7b057cf99e9a4136cd";
    // Provider: lettura pubblica (Polygon mainnet)
    const RPC_URL = "https://rpc-mainnet.matic.quiknode.pro/"; // <-- usa il tuo provider o lascia che l'utente abbia MetaMask
    // ABI minimal ERC20
    const ERC20_ABI = [
      "function name() view returns (string)",
      "function symbol() view returns (string)",
      "function totalSupply() view returns (uint256)",
      "function balanceOf(address owner) view returns (uint256)",
      "event Transfer(address indexed from,address indexed to,uint256 value)"
    ];

    // utilities
    function short(addr){ return addr ? addr.slice(0,6) + "..." + addr.slice(-4) : "—"; }
    function human(n){ try { return (Number(ethers.utils.formatUnits(n,18))).toLocaleString('en-US'); } catch(e){ return n.toString(); } }

    // init provider (read-only). If MetaMask present, prefer it for user balance
    let provider = null;
    if (window.ethereum) {
      provider = new ethers.providers.Web3Provider(window.ethereum);
    } else {
      provider = new ethers.providers.JsonRpcProvider(RPC_URL);
    }
    const contract = new ethers.Contract(CONTRACT_ADDRESS, ERC20_ABI, provider);

    async function refreshOnChain(){
      try {
        const [name, symbol, totalSupply] = await Promise.all([
          contract.name(), contract.symbol(), contract.totalSupply()
        ]);
        document.getElementById('name').textContent = name;
        document.getElementById('symbol').textContent = symbol;
        document.getElementById('supply').textContent = human(totalSupply);
      } catch(err){
        console.error("On-chain read failed:", err);
        document.getElementById('name').textContent = "N/A";
        document.getElementById('symbol').textContent = "N/A";
        document.getElementById('supply').textContent = "N/A";
      }
    }

    // wallet connection for user balance only
    async function connectWallet(){
      if (!window.ethereum) { alert("Installa MetaMask per connettere il wallet"); return; }
      try {
        await window.ethereum.request({ method: "eth_requestAccounts" });
        provider = new ethers.providers.Web3Provider(window.ethereum);
        const signer = provider.getSigner();
        const addr = await signer.getAddress();
        document.getElementById('acct').textContent = short(addr);
        // get balance
        const bal = await contract.connect(signer).balanceOf(addr);
        document.getElementById('balance').textContent = human(bal);
      } catch(e){
        console.error(e);
        alert("Connessione wallet fallita");
      }
    }

    // copy contract address
    function copyAddr(){ navigator.clipboard.writeText(CONTRACT_ADDRESS).then(()=>alert("Indirizzo copiato")); }

    // init
    document.getElementById('connect').addEventListener('click', connectWallet);
    refreshOnChain();
    // refresh supply every 30s
    setInterval(refreshOnChain, 30000);
  </script>
</body>
</html>
